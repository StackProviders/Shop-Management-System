# Architecture Diagram

## System Overview

```
┌─────────────────────────────────────────────────────────────────┐
│                        Shop Management App                       │
└─────────────────────────────────────────────────────────────────┘
                                 │
                    ┌────────────┴────────────┐
                    │                         │
            ┌───────▼────────┐       ┌───────▼────────┐
            │   Frontend     │       │    Backend     │
            │   (React)      │◄─────►│   (Services)   │
            └────────────────┘       └────────────────┘
```

## Frontend Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                          Application                             │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                      App Layer                            │  │
│  │  ┌────────┐  ┌────────┐  ┌────────┐  ┌────────┐        │  │
│  │  │ Routes │  │Provider│  │ Router │  │ Global │        │  │
│  │  └────────┘  └────────┘  └────────┘  └────────┘        │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                    Features Layer                         │  │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐              │  │
│  │  │   Auth   │  │   Shop   │  │  Shared  │              │  │
│  │  │          │  │          │  │          │              │  │
│  │  │ • API    │  │ • API    │  │ • Hooks  │              │  │
│  │  │ • Hooks  │  │ • Hooks  │  │ • Utils  │              │  │
│  │  │ • Comps  │  │ • Comps  │  │ • Types  │              │  │
│  │  │ • Types  │  │ • Types  │  │          │              │  │
│  │  │          │  │ • Utils  │  │          │              │  │
│  │  └──────────┘  └──────────┘  └──────────┘              │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                  Shared Components                        │  │
│  │  ┌────────┐  ┌────────┐  ┌────────┐  ┌────────┐        │  │
│  │  │   UI   │  │ Layout │  │ Common │  │ Modals │        │  │
│  │  └────────┘  └────────┘  └────────┘  └────────┘        │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                  Infrastructure                           │  │
│  │  ┌────────┐  ┌────────┐  ┌────────┐  ┌────────┐        │  │
│  │  │  Lib   │  │ Stores │  │Services│  │  Utils │        │  │
│  │  └────────┘  └────────┘  └────────┘  └────────┘        │  │
│  └──────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

## Feature Structure

```
┌─────────────────────────────────────────────────────────────────┐
│                         Feature Module                           │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                         API Layer                         │  │
│  │  ┌────────────────────────────────────────────────────┐  │  │
│  │  │  • API calls to backend                            │  │  │
│  │  │  • Request/Response handling                       │  │  │
│  │  │  • Error handling                                  │  │  │
│  │  └────────────────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────────────┘  │
│                          ▲                                       │
│                          │                                       │
│  ┌──────────────────────┴───────────────────────────────────┐  │
│  │                      Hooks Layer                          │  │
│  │  ┌────────────────────────────────────────────────────┐  │  │
│  │  │  • Business logic                                  │  │  │
│  │  │  • State management                                │  │  │
│  │  │  • Side effects                                    │  │  │
│  │  │  • Data fetching                                   │  │  │
│  │  └────────────────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────────────┘  │
│                          ▲                                       │
│                          │                                       │
│  ┌──────────────────────┴───────────────────────────────────┐  │
│  │                   Components Layer                        │  │
│  │  ┌────────────────────────────────────────────────────┐  │  │
│  │  │  • UI components                                   │  │  │
│  │  │  • Minimal logic                                   │  │  │
│  │  │  • Props-based                                     │  │  │
│  │  └────────────────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                      Types Layer                          │  │
│  │  • TypeScript interfaces                                  │  │
│  │  • Type definitions                                       │  │
│  │  • Enums                                                  │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                      Utils Layer                          │  │
│  │  • Helper functions                                       │  │
│  │  • Validation                                             │  │
│  │  • Formatting                                             │  │
│  └──────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

## Data Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                         User Action                              │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│                        Component                                 │
│  • Renders UI                                                    │
│  • Handles user input                                            │
│  • Calls hooks                                                   │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│                          Hook                                    │
│  • Business logic                                                │
│  • State management                                              │
│  • Calls API                                                     │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│                          API                                     │
│  • Makes HTTP requests                                           │
│  • Handles responses                                             │
│  • Error handling                                                │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│                        Service                                   │
│  • Backend integration                                           │
│  • Database operations                                           │
│  • Business rules                                                │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│                        Database                                  │
│  • Data persistence                                              │
│  • Queries                                                       │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             │ Response
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│                     State Update                                 │
│  • Update local state                                            │
│  • Update cache (SWR)                                            │
│  • Trigger re-render                                             │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│                      UI Re-render                                │
│  • Display updated data                                          │
│  • Show success/error                                            │
└─────────────────────────────────────────────────────────────────┘
```

## Auth Feature Flow

```
┌──────────────┐
│  LoginForm   │
└──────┬───────┘
       │ User enters email/phone
       ▼
┌──────────────────┐
│ useAuthActions   │
│  • sendOTP()     │
└──────┬───────────┘
       │
       ▼
┌──────────────────┐
│   authApi        │
│  • sendOTP()     │
└──────┬───────────┘
       │
       ▼
┌──────────────────┐
│  Auth Service    │
│  • Generate OTP  │
│  • Send email    │
└──────┬───────────┘
       │
       │ OTP sent
       ▼
┌──────────────────┐
│  OTP Input       │
└──────┬───────────┘
       │ User enters OTP
       ▼
┌──────────────────┐
│ useAuthActions   │
│  • verifyOTP()   │
└──────┬───────────┘
       │
       ▼
┌──────────────────┐
│   authApi        │
│  • verifyOTP()   │
└──────┬───────────┘
       │
       ▼
┌──────────────────┐
│  Auth Service    │
│  • Verify OTP    │
│  • Create session│
└──────┬───────────┘
       │
       │ Success
       ▼
┌──────────────────┐
│  Auth Store      │
│  • Set user      │
│  • Update state  │
└──────┬───────────┘
       │
       ▼
┌──────────────────┐
│  Navigate to     │
│  Dashboard       │
└──────────────────┘
```

## Shop Feature Flow

```
┌──────────────────┐
│  ShopDashboard   │
└──────┬───────────┘
       │ Load shops
       ▼
┌──────────────────┐
│ useUserShops     │
│  • SWR fetch     │
└──────┬───────────┘
       │
       ▼
┌──────────────────┐
│   shopApi        │
│  • getUserShops()│
└──────┬───────────┘
       │
       ▼
┌──────────────────┐
│  Shop Service    │
│  • Query DB      │
│  • Get shops     │
└──────┬───────────┘
       │
       │ Return shops
       ▼
┌──────────────────┐
│  SWR Cache       │
│  • Cache data    │
│  • Auto refresh  │
└──────┬───────────┘
       │
       ▼
┌──────────────────┐
│  ShopContext     │
│  • Set shops     │
│  • Set current   │
└──────┬───────────┘
       │
       ▼
┌──────────────────┐
│  UI Update       │
│  • Display shops │
└──────────────────┘
```

## Component Hierarchy

```
App
├── AuthProvider
│   └── ShopProvider
│       └── Router
│           ├── AuthPage
│           │   └── LoginForm
│           │       ├── Input
│           │       ├── Button
│           │       └── OTPInput
│           │
│           ├── ShopsPage
│           │   └── ShopDashboard
│           │       ├── ShopList
│           │       │   └── ShopItem
│           │       ├── ShopModal
│           │       └── CreateShopForm
│           │
│           └── SettingsPage
│               └── ProfileForm
│                   ├── Input
│                   ├── Button
│                   └── FileUpload
```

## State Management

```
┌─────────────────────────────────────────────────────────────────┐
│                        State Layers                              │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                   Global State (Zustand)                  │  │
│  │  • Auth state                                             │  │
│  │  • User data                                              │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                  Context State (React)                    │  │
│  │  • Shop context                                           │  │
│  │  • Current shop                                           │  │
│  │  • User shops                                             │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                   Server State (SWR)                      │  │
│  │  • Cached data                                            │  │
│  │  • Auto revalidation                                      │  │
│  │  • Optimistic updates                                     │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                  Local State (useState)                   │  │
│  │  • Form data                                              │  │
│  │  • UI state                                               │  │
│  │  • Temporary data                                         │  │
│  └──────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

## Import Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                      Component File                              │
│                                                                  │
│  import { useAuthActions } from '@/features/auth'                │
│                                    │                             │
│                                    ▼                             │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │            features/auth/index.ts                         │  │
│  │  export * from './hooks'                                  │  │
│  │                    │                                      │  │
│  │                    ▼                                      │  │
│  │  ┌──────────────────────────────────────────────────┐   │  │
│  │  │        features/auth/hooks/index.ts              │   │  │
│  │  │  export * from './use-auth-actions'              │   │  │
│  │  │                    │                              │   │  │
│  │  │                    ▼                              │   │  │
│  │  │  ┌──────────────────────────────────────────┐   │   │  │
│  │  │  │  features/auth/hooks/use-auth-actions.ts │   │   │  │
│  │  │  │  export function useAuthActions() {...}  │   │   │  │
│  │  │  └──────────────────────────────────────────┘   │   │  │
│  │  └──────────────────────────────────────────────────┘   │  │
│  └──────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

## Legend

```
┌─────┐
│ Box │  = Module/Component
└─────┘

   │
   ▼     = Data/Control Flow

   ◄──►  = Bidirectional Communication

   •     = List Item/Feature
```
