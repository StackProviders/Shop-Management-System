{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Shop-Management-System/shop-management-app/src/components/shop/shop-switcher.tsx"],"sourcesContent":["import {\r\n    ChevronsUpDown,\r\n    Plus,\r\n    Store,\r\n    Loader2,\r\n    Settings,\r\n    Crown,\r\n    Shield,\r\n    UserCog,\r\n    Users,\r\n    Eye,\r\n    LayoutGrid\r\n} from 'lucide-react'\r\nimport { memo, useMemo, useState, useTransition, useEffect } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\nimport { useShopContext, getShopAccessHistory } from '@/features/shop'\r\nimport { CreateShopModal } from '@/features/shop'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Skeleton } from '@/components/ui/skeleton'\r\nimport {\r\n    DropdownMenu,\r\n    DropdownMenuContent,\r\n    DropdownMenuItem,\r\n    DropdownMenuLabel,\r\n    DropdownMenuSeparator,\r\n    DropdownMenuTrigger\r\n} from '@/components/ui/dropdown-menu'\r\nimport {\r\n    SidebarMenu,\r\n    SidebarMenuButton,\r\n    SidebarMenuItem,\r\n    useSidebar\r\n} from '@/components/ui/sidebar'\r\nimport { Image } from '@/components/ui/image'\r\nimport { cn } from '@/lib/utils'\r\n\r\nconst ShopLogo = memo(\r\n    ({\r\n        logoUrl,\r\n        shopName,\r\n        size = 'default'\r\n    }: {\r\n        logoUrl?: string\r\n        shopName: string\r\n        size?: 'default' | 'small'\r\n    }) => (\r\n        <div\r\n            className={cn(\r\n                'bg-sidebar-accent text-sidebar-accent-foreground flex items-center justify-center rounded-lg overflow-hidden shrink-0',\r\n                size === 'default'\r\n                    ? 'aspect-square size-8'\r\n                    : 'size-6 rounded-md border'\r\n            )}\r\n        >\r\n            {logoUrl ? (\r\n                <Image\r\n                    src={logoUrl}\r\n                    alt={shopName}\r\n                    className=\"size-full object-cover\"\r\n                    loading=\"lazy\"\r\n                />\r\n            ) : (\r\n                <Store className={size === 'default' ? 'size-4' : 'size-3.5'} />\r\n            )}\r\n        </div>\r\n    )\r\n)\r\nShopLogo.displayName = 'ShopLogo'\r\n\r\nconst getRoleIcon = (role: string) => {\r\n    switch (role.toLowerCase()) {\r\n        case 'owner':\r\n            return Crown\r\n        case 'admin':\r\n            return Shield\r\n        case 'manager':\r\n            return UserCog\r\n        case 'staff':\r\n            return Users\r\n        case 'viewer':\r\n            return Eye\r\n        default:\r\n            return Users\r\n    }\r\n}\r\n\r\nexport function ShopSwitcher() {\r\n    const { isMobile } = useSidebar()\r\n    const { userShops, currentShop, setCurrentShop, loading, refreshShops } =\r\n        useShopContext()\r\n    const [isPending, startTransition] = useTransition()\r\n    const [createModalOpen, setCreateModalOpen] = useState(false)\r\n    const [accessHistory, setAccessHistory] = useState<Record<string, number>>(\r\n        {}\r\n    )\r\n    const router = useRouter()\r\n\r\n    useEffect(() => {\r\n        getShopAccessHistory().then(setAccessHistory)\r\n    }, [currentShop])\r\n\r\n    const sortedShops = useMemo(() => {\r\n        return [...userShops]\r\n            .map((shop) => ({\r\n                ...shop,\r\n                lastAccessedAt: accessHistory[shop.shopId] || 0\r\n            }))\r\n            .sort((a, b) => (b.lastAccessedAt || 0) - (a.lastAccessedAt || 0))\r\n            .slice(0, 5)\r\n    }, [userShops, accessHistory])\r\n\r\n    const handleShopSwitch = (shop: typeof currentShop) => {\r\n        startTransition(() => {\r\n            setCurrentShop(shop)\r\n        })\r\n    }\r\n\r\n    if (loading || !currentShop) {\r\n        return (\r\n            <SidebarMenu>\r\n                <SidebarMenuItem>\r\n                    <SidebarMenuButton size=\"lg\" disabled>\r\n                        <Skeleton className=\"size-8 rounded-lg\" />\r\n                        <div className=\"grid flex-1 gap-1\">\r\n                            <Skeleton className=\"h-4 w-24\" />\r\n                            <Skeleton className=\"h-3 w-16\" />\r\n                        </div>\r\n                    </SidebarMenuButton>\r\n                </SidebarMenuItem>\r\n            </SidebarMenu>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <SidebarMenu>\r\n                <SidebarMenuItem>\r\n                    <DropdownMenu>\r\n                        <DropdownMenuTrigger asChild>\r\n                            <SidebarMenuButton\r\n                                size=\"lg\"\r\n                                disabled={isPending}\r\n                                className=\"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground\"\r\n                            >\r\n                                {isPending ? (\r\n                                    <Loader2 className=\"size-8 animate-spin\" />\r\n                                ) : (\r\n                                    <ShopLogo\r\n                                        logoUrl={currentShop.logoUrl}\r\n                                        shopName={currentShop.shopName}\r\n                                    />\r\n                                )}\r\n                                <div className=\"grid flex-1 text-left text-sm leading-tight\">\r\n                                    <span className=\"truncate font-medium\">\r\n                                        {currentShop.shopName}\r\n                                    </span>\r\n                                    <span className=\"truncate text-xs text-muted-foreground capitalize\">\r\n                                        {currentShop.role}\r\n                                    </span>\r\n                                </div>\r\n                                <ChevronsUpDown className=\"ml-auto\" />\r\n                            </SidebarMenuButton>\r\n                        </DropdownMenuTrigger>\r\n                        <DropdownMenuContent\r\n                            className=\"w-(--radix-dropdown-menu-trigger-width) min-w-56 rounded-lg\"\r\n                            align=\"start\"\r\n                            side={isMobile ? 'bottom' : 'right'}\r\n                            sideOffset={4}\r\n                        >\r\n                            <DropdownMenuLabel className=\"text-muted-foreground text-xs\">\r\n                                Recent Shops\r\n                            </DropdownMenuLabel>\r\n                            {sortedShops.map((shop) => (\r\n                                <DropdownMenuItem\r\n                                    key={shop.shopId}\r\n                                    onClick={() => handleShopSwitch(shop)}\r\n                                    disabled={\r\n                                        isPending ||\r\n                                        shop.shopId === currentShop.shopId\r\n                                    }\r\n                                    className={cn(\r\n                                        'gap-2 p-2',\r\n                                        shop.shopId === currentShop.shopId &&\r\n                                        'bg-accent'\r\n                                    )}\r\n                                >\r\n                                    <ShopLogo\r\n                                        logoUrl={shop.logoUrl}\r\n                                        shopName={shop.shopName}\r\n                                        size=\"small\"\r\n                                    />\r\n                                    <div className=\"flex items-center flex-1 min-w-0 gap-2\">\r\n                                        <div className=\"flex flex-col flex-1 min-w-0\">\r\n                                            <span className=\"truncate font-medium\">\r\n                                                {shop.shopName}\r\n                                            </span>\r\n                                            <div className=\"flex items-center gap-1\">\r\n                                                {(() => {\r\n                                                    const RoleIcon =\r\n                                                        getRoleIcon(shop.role)\r\n                                                    return (\r\n                                                        <RoleIcon className=\"size-3 text-muted-foreground\" />\r\n                                                    )\r\n                                                })()}\r\n                                                <span className=\"text-xs text-muted-foreground truncate capitalize\">\r\n                                                    {shop.role}\r\n                                                </span>\r\n                                            </div>\r\n                                        </div>\r\n                                        {shop.isOwner && (\r\n                                            <Button\r\n                                                variant=\"ghost\"\r\n                                                size=\"xs\"\r\n                                                onClick={(e) => {\r\n                                                    e.stopPropagation()\r\n                                                    setCurrentShop(shop)\r\n                                                    router.push('/settings')\r\n                                                }}\r\n                                            >\r\n                                                <Settings className=\"size-3.5\" />\r\n                                            </Button>\r\n                                        )}\r\n                                    </div>\r\n                                </DropdownMenuItem>\r\n                            ))}\r\n                            <DropdownMenuSeparator />\r\n                            <DropdownMenuItem\r\n                                className=\"gap-2 p-2\"\r\n                                onClick={() => router.push('/shops')}\r\n                            >\r\n                                <div className=\"flex size-6 items-center justify-center rounded-md border bg-transparent\">\r\n                                    <LayoutGrid className=\"size-4\" />\r\n                                </div>\r\n                                <div className=\"text-muted-foreground font-medium\">\r\n                                    Manage all shops\r\n                                </div>\r\n                            </DropdownMenuItem>\r\n                            <DropdownMenuItem\r\n                                className=\"gap-2 p-2\"\r\n                                onClick={() => setCreateModalOpen(true)}\r\n                            >\r\n                                <div className=\"flex size-6 items-center justify-center rounded-md border bg-transparent\">\r\n                                    <Plus className=\"size-4\" />\r\n                                </div>\r\n                                <div className=\"text-muted-foreground font-medium\">\r\n                                    Create shop\r\n                                </div>\r\n                            </DropdownMenuItem>\r\n                        </DropdownMenuContent>\r\n                    </DropdownMenu>\r\n                </SidebarMenuItem>\r\n            </SidebarMenu>\r\n\r\n            <CreateShopModal\r\n                open={createModalOpen}\r\n                onOpenChange={setCreateModalOpen}\r\n                onSuccess={refreshShops}\r\n            />\r\n        </>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 476, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Shop-Management-System/shop-management-app/src/components/shop/shop-item.tsx"],"sourcesContent":["import { useState } from 'react'\r\nimport { MoreVertical, Store } from 'lucide-react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Badge, BadgeDot } from '@/components/ui/badge'\r\nimport {\r\n    DropdownMenu,\r\n    DropdownMenuContent,\r\n    DropdownMenuItem,\r\n    DropdownMenuTrigger\r\n} from '@/components/ui/dropdown-menu'\r\nimport { ConfirmationDialog } from '@/components/common'\r\nimport {\r\n    Item,\r\n    ItemActions,\r\n    ItemContent,\r\n    ItemDescription,\r\n    ItemMedia,\r\n    ItemTitle\r\n} from '@/components/ui/item'\r\nimport { getPlatform } from '@/utils/platform-detection'\r\nimport { Image } from '../ui/image'\r\n\r\ninterface ShopItemProps {\r\n    shop: {\r\n        id: string\r\n        name: string\r\n        status: string\r\n        isCurrent: boolean\r\n        description?: string\r\n        logo_url?: string\r\n        shop_category?: string\r\n    }\r\n    onOpen?: (shopId: string) => void\r\n    onEdit?: (shopId: string) => void\r\n    onDelete?: (shopId: string) => void\r\n}\r\n\r\nexport default function ShopItem({\r\n    shop,\r\n    onOpen,\r\n    onEdit,\r\n    onDelete\r\n}: ShopItemProps) {\r\n    const [deleteDialogOpen, setDeleteDialogOpen] = useState(false)\r\n    const { isMobile } = getPlatform()\r\n\r\n    const handleDelete = () => {\r\n        onDelete?.(shop.id)\r\n        setDeleteDialogOpen(false)\r\n    }\r\n\r\n    return (\r\n        <div className=\"w-full\">\r\n            <Item\r\n                variant=\"outline\"\r\n                className=\"transition-all duration-200 hover:bg-accent/50\"\r\n                size=\"sm\"\r\n            >\r\n                <ItemMedia\r\n                    variant=\"icon\"\r\n                    className=\"bg-primary/10 text-primary\"\r\n                >\r\n                    {shop.logo_url ? (\r\n                        <Image src={shop.logo_url} alt={shop.name} />\r\n                    ) : (\r\n                        <Store className=\"size-4\" />\r\n                    )}\r\n                </ItemMedia>\r\n\r\n                <ItemContent className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex flex-col gap-0.5\">\r\n                        <div className=\"flex items-center gap-2 min-w-0\">\r\n                            <ItemTitle className=\"text-foreground font-semibold truncate\">\r\n                                {shop.name}\r\n                            </ItemTitle>\r\n                            {shop.isCurrent && (\r\n                                <Badge size=\"sm\" variant=\"warning\">\r\n                                    <BadgeDot />{' '}\r\n                                    <span className=\"sr-only sm:not-sr-only\">\r\n                                        Current Shop\r\n                                    </span>\r\n                                </Badge>\r\n                            )}\r\n                        </div>\r\n\r\n                        <ItemDescription>\r\n                            <span className=\"text-xs text-muted-foreground truncate\">\r\n                                {shop.shop_category || (\r\n                                    <span className=\"italic\">No category</span>\r\n                                )}\r\n                            </span>\r\n                        </ItemDescription>\r\n                    </div>\r\n                </ItemContent>\r\n\r\n                <ItemActions className=\"flex items-center gap-2\">\r\n                    <Button\r\n                        size={isMobile ? 'xs' : 'sm'}\r\n                        onClick={() => onOpen?.(shop.id)}\r\n                    >\r\n                        Open\r\n                    </Button>\r\n                    <DropdownMenu>\r\n                        <DropdownMenuTrigger asChild>\r\n                            <Button\r\n                                variant=\"outline\"\r\n                                size={isMobile ? 'xs' : 'sm'}\r\n                            >\r\n                                <MoreVertical className=\"size-4\" />\r\n                                <span className=\"sr-only\">More options</span>\r\n                            </Button>\r\n                        </DropdownMenuTrigger>\r\n                        <DropdownMenuContent align=\"end\" className=\"w-40\">\r\n                            <DropdownMenuItem onClick={() => onEdit?.(shop.id)}>\r\n                                Rename\r\n                            </DropdownMenuItem>\r\n                            <DropdownMenuItem onClick={() => onOpen?.(shop.id)}>\r\n                                Open\r\n                            </DropdownMenuItem>\r\n                            <DropdownMenuItem\r\n                                className=\"text-destructive focus:text-destructive\"\r\n                                onClick={() => setDeleteDialogOpen(true)}\r\n                            >\r\n                                Delete\r\n                            </DropdownMenuItem>\r\n                        </DropdownMenuContent>\r\n                    </DropdownMenu>\r\n                </ItemActions>\r\n            </Item>\r\n\r\n            <ConfirmationDialog\r\n                open={deleteDialogOpen}\r\n                onOpenChange={setDeleteDialogOpen}\r\n                onConfirm={handleDelete}\r\n                title=\"Delete Shop\"\r\n                description={`Are you sure you want to delete \"${shop.name}\"? This action cannot be undone.`}\r\n                confirmText=\"Delete\"\r\n                variant=\"destructive\"\r\n            />\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AACA;AACA;AACA;AAMA;AAAA;AACA;AAQA;AACA;;;;;;;;;;;;AAiBe,SAAS,SAAS,EAC7B,IAAI,EACJ,MAAM,EACN,MAAM,EACN,QAAQ,EACI;;IACZ,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,wRAAQ,EAAC;IACzD,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,uJAAW;IAEhC,MAAM,eAAe;QACjB,WAAW,KAAK,EAAE;QAClB,oBAAoB;IACxB;IAEA,qBACI,4SAAC;QAAI,WAAU;;0BACX,4SAAC,2IAAI;gBACD,SAAQ;gBACR,WAAU;gBACV,MAAK;;kCAEL,4SAAC,gJAAS;wBACN,SAAQ;wBACR,WAAU;kCAET,KAAK,QAAQ,iBACV,4SAAC,6IAAK;4BAAC,KAAK,KAAK,QAAQ;4BAAE,KAAK,KAAK,IAAI;;;;;iDAEzC,4SAAC,oSAAK;4BAAC,WAAU;;;;;;;;;;;kCAIzB,4SAAC,kJAAW;wBAAC,WAAU;kCACnB,cAAA,4SAAC;4BAAI,WAAU;;8CACX,4SAAC;oCAAI,WAAU;;sDACX,4SAAC,gJAAS;4CAAC,WAAU;sDAChB,KAAK,IAAI;;;;;;wCAEb,KAAK,SAAS,kBACX,4SAAC,6IAAK;4CAAC,MAAK;4CAAK,SAAQ;;8DACrB,4SAAC,gJAAQ;;;;;gDAAI;8DACb,4SAAC;oDAAK,WAAU;8DAAyB;;;;;;;;;;;;;;;;;;8CAOrD,4SAAC,sJAAe;8CACZ,cAAA,4SAAC;wCAAK,WAAU;kDACX,KAAK,aAAa,kBACf,4SAAC;4CAAK,WAAU;sDAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;kCAO7C,4SAAC,kJAAW;wBAAC,WAAU;;0CACnB,4SAAC,+IAAM;gCACH,MAAM,WAAW,OAAO;gCACxB,SAAS,IAAM,SAAS,KAAK,EAAE;0CAClC;;;;;;0CAGD,4SAAC,+JAAY;;kDACT,4SAAC,sKAAmB;wCAAC,OAAO;kDACxB,cAAA,4SAAC,+IAAM;4CACH,SAAQ;4CACR,MAAM,WAAW,OAAO;;8DAExB,4SAAC,iUAAY;oDAAC,WAAU;;;;;;8DACxB,4SAAC;oDAAK,WAAU;8DAAU;;;;;;;;;;;;;;;;;kDAGlC,4SAAC,sKAAmB;wCAAC,OAAM;wCAAM,WAAU;;0DACvC,4SAAC,mKAAgB;gDAAC,SAAS,IAAM,SAAS,KAAK,EAAE;0DAAG;;;;;;0DAGpD,4SAAC,mKAAgB;gDAAC,SAAS,IAAM,SAAS,KAAK,EAAE;0DAAG;;;;;;0DAGpD,4SAAC,mKAAgB;gDACb,WAAU;gDACV,SAAS,IAAM,oBAAoB;0DACtC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAQjB,4SAAC,0LAAkB;gBACf,MAAM;gBACN,cAAc;gBACd,WAAW;gBACX,OAAM;gBACN,aAAa,CAAC,iCAAiC,EAAE,KAAK,IAAI,CAAC,gCAAgC,CAAC;gBAC5F,aAAY;gBACZ,SAAQ;;;;;;;;;;;;AAIxB;GAxGwB;KAAA"}},
    {"offset": {"line": 749, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Shop-Management-System/shop-management-app/src/components/shop/shop-dashboard.tsx"],"sourcesContent":["import { useState, useMemo } from 'react'\r\nimport { RefreshCw, UserRound, Store, Plus } from 'lucide-react'\r\nimport { EmptyState, LoadingState } from '@/components/common'\r\nimport { Button } from '@/components/ui/button'\r\nimport { SearchInput } from '@/components/ui/search-input'\r\nimport { ScrollArea } from '@/components/ui/scroll-area'\r\nimport ShopItem from './shop-item'\r\nimport { CreateShopModal, EditShopModal } from '@/features/shop'\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\r\nimport { Heading4 } from '@/components/ui/typography'\r\nimport { LogoutButton } from '../auth'\r\nimport { toast } from 'sonner'\r\nimport { useCurrentUser } from '@/features/auth'\r\nimport { useShopActions, useShopContext } from '@/features/shop'\r\nimport type { UserShopAccess } from '@/features/shop'\r\nimport { useRouter } from 'next/navigation'\r\n\r\nexport default function ShopDashboard() {\r\n    const [searchQuery, setSearchQuery] = useState('')\r\n    const [createModalOpen, setCreateModalOpen] = useState(false)\r\n    const [editingShopId, setEditingShopId] = useState<string | null>(null)\r\n    const user = useCurrentUser()\r\n    const { userShops, loading, refreshShops, setCurrentShop } =\r\n        useShopContext()\r\n    const { deleteShop } = useShopActions()\r\n    const router = useRouter()\r\n\r\n    const handleEditShop = (shopId: string) => {\r\n        setEditingShopId(shopId)\r\n    }\r\n\r\n    const handleDeleteShop = async (shopId: string) => {\r\n        try {\r\n            await deleteShop(shopId)\r\n            await refreshShops()\r\n            toast.success('Shop deleted successfully')\r\n        } catch {\r\n            toast.error('Failed to delete shop')\r\n        }\r\n    }\r\n\r\n    const handleOpenShop = (shopId: string) => {\r\n        const shop = userShops.find((s) => s.shopId === shopId)\r\n        if (shop) {\r\n            setCurrentShop(shop)\r\n            router.push('/')\r\n        }\r\n    }\r\n\r\n    const { myShops, sharedShops } = useMemo(() => {\r\n        const shopList = Array.isArray(userShops) ? userShops : []\r\n        const filtered = searchQuery\r\n            ? shopList.filter((shop) =>\r\n                shop.shopName\r\n                    .toLowerCase()\r\n                    .includes(searchQuery.toLowerCase())\r\n            )\r\n            : shopList\r\n\r\n        return {\r\n            myShops: filtered.filter((shop) => shop.isOwner),\r\n            sharedShops: filtered.filter((shop) => !shop.isOwner)\r\n        }\r\n    }, [userShops, searchQuery])\r\n\r\n    const renderShopList = (shopList: typeof userShops) => (\r\n        <ScrollArea className=\"h-[50vh] max-h-[500px]\">\r\n            <div className=\"space-y-3 pr-4\">\r\n                {shopList.map((shop: UserShopAccess) => (\r\n                    <ShopItem\r\n                        key={shop.shopId}\r\n                        shop={{\r\n                            id: shop.shopId,\r\n                            name: shop.shopName,\r\n                            status: 'active',\r\n                            isCurrent: false,\r\n                            logo_url: shop.logoUrl,\r\n                            shop_category: shop.shopCategory,\r\n                            description: shop.shopAddress\r\n                        }}\r\n                        onOpen={handleOpenShop}\r\n                        onEdit={handleEditShop}\r\n                        onDelete={handleDeleteShop}\r\n                    />\r\n                ))}\r\n            </div>\r\n        </ScrollArea>\r\n    )\r\n\r\n    return (\r\n        <>\r\n            <div className=\"w-full max-w-4xl mx-auto bg-background rounded-lg shadow-lg overflow-hidden flex flex-col min-h-[90vh] max-h-[90vh]\">\r\n                {/* Header */}\r\n                <div className=\"bg-card border-b px-4 sm:px-6 py-2 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-4\">\r\n                    <Heading4 className=\"text-card-foreground\">\r\n                        Shop List\r\n                    </Heading4>\r\n                    <SearchInput\r\n                        value={searchQuery}\r\n                        onValueChange={setSearchQuery}\r\n                        placeholder=\"Search Shop\"\r\n                        wrapperClassName=\"w-full sm:w-auto\"\r\n                    />\r\n                </div>\r\n\r\n                {/* Main Content */}\r\n                <div className=\"p-4 sm:p-6 pt-2 sm:!pt-4 flex-1 overflow-hidden flex flex-col\">\r\n                    <Tabs\r\n                        defaultValue=\"my_shop\"\r\n                        className=\"text-sm text-muted-foreground\"\r\n                    >\r\n                        <div className=\"flex items-end justify-between border-b\">\r\n                            <TabsList\r\n                                variant=\"underline\"\r\n                                className=\"border-none gap-4 sm:gap-6\"\r\n                            >\r\n                                <TabsTrigger value=\"shared_shop\">\r\n                                    <UserRound className=\"size-4\" /> Shared Shop\r\n                                </TabsTrigger>\r\n                                <TabsTrigger value=\"my_shop\">\r\n                                    <Store className=\"size-4\" /> My Shop\r\n                                </TabsTrigger>\r\n                            </TabsList>\r\n                            <Button\r\n                                variant=\"ghost\"\r\n                                size=\"sm\"\r\n                                className=\"mb-0.5\"\r\n                                onClick={() => refreshShops()}\r\n                                disabled={loading}\r\n                            >\r\n                                <RefreshCw\r\n                                    className={`size-4 ${loading ? 'animate-spin' : ''}`}\r\n                                />\r\n                            </Button>\r\n                        </div>\r\n                        <TabsContent value=\"shared_shop\" className=\"mt-4\">\r\n                            {loading ? (\r\n                                <LoadingState />\r\n                            ) : sharedShops.length === 0 ? (\r\n                                <EmptyState\r\n                                    title=\"No shared shops\"\r\n                                    description=\"Shops shared with you will appear here\"\r\n                                />\r\n                            ) : (\r\n                                renderShopList(sharedShops)\r\n                            )}\r\n                        </TabsContent>\r\n                        <TabsContent value=\"my_shop\" className=\"mt-4\">\r\n                            {loading ? (\r\n                                <LoadingState />\r\n                            ) : myShops.length === 0 ? (\r\n                                <EmptyState\r\n                                    title=\"No shops yet\"\r\n                                    description=\"Create your first shop to get started\"\r\n                                    action={\r\n                                        <Button\r\n                                            size=\"sm\"\r\n                                            onClick={() =>\r\n                                                setCreateModalOpen(true)\r\n                                            }\r\n                                        >\r\n                                            <Plus className=\"size-4\" />\r\n                                            Create Shop\r\n                                        </Button>\r\n                                    }\r\n                                />\r\n                            ) : (\r\n                                renderShopList(myShops)\r\n                            )}\r\n                        </TabsContent>\r\n                    </Tabs>\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                <div className=\"bg-muted/30 px-4 sm:px-6 py-3 border-t mt-auto\">\r\n                    <div className=\"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3\">\r\n                        <div className=\"text-xs sm:text-sm text-muted-foreground text-center sm:text-left\">\r\n                            Currently logged in with{' '}\r\n                            {user?.email ? 'Email' : 'Phone'}:{' '}\r\n                            <span className=\"font-semibold text-foreground\">\r\n                                {user?.email || user?.phone || 'N/A'}\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2 sm:gap-3\">\r\n                            <Button\r\n                                size=\"sm\"\r\n                                onClick={() => setCreateModalOpen(true)}\r\n                                className=\"flex-1 sm:flex-none\"\r\n                            >\r\n                                <Plus className=\"size-4\" />\r\n                                Create Shop\r\n                            </Button>\r\n                            <LogoutButton\r\n                                variant=\"destructive\"\r\n                                size=\"sm\"\r\n                                className=\"flex-1 sm:flex-none\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <CreateShopModal\r\n                open={createModalOpen}\r\n                onOpenChange={setCreateModalOpen}\r\n                onSuccess={refreshShops}\r\n            />\r\n\r\n            {editingShopId && (\r\n                <EditShopModal\r\n                    shopId={editingShopId}\r\n                    open={!!editingShopId}\r\n                    onOpenChange={(open) => !open && setEditingShopId(null)}\r\n                    onSuccess={refreshShops}\r\n                />\r\n            )}\r\n        </>\r\n    )\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAEA;;;;;;;;;;;;;;;;;;AAEe,SAAS;;IACpB,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,wRAAQ,EAAC;IAC/C,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,wRAAQ,EAAC;IACvD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,wRAAQ,EAAgB;IAClE,MAAM,OAAO,IAAA,+KAAc;IAC3B,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,YAAY,EAAE,cAAc,EAAE,GACtD,IAAA,+KAAc;IAClB,MAAM,EAAE,UAAU,EAAE,GAAG,IAAA,+KAAc;IACrC,MAAM,SAAS,IAAA,iQAAS;IAExB,MAAM,iBAAiB,CAAC;QACpB,iBAAiB;IACrB;IAEA,MAAM,mBAAmB,OAAO;QAC5B,IAAI;YACA,MAAM,WAAW;YACjB,MAAM;YACN,oRAAK,CAAC,OAAO,CAAC;QAClB,EAAE,OAAM;YACJ,oRAAK,CAAC,KAAK,CAAC;QAChB;IACJ;IAEA,MAAM,iBAAiB,CAAC;QACpB,MAAM,OAAO,UAAU,IAAI,CAAC,CAAC,IAAM,EAAE,MAAM,KAAK;QAChD,IAAI,MAAM;YACN,eAAe;YACf,OAAO,IAAI,CAAC;QAChB;IACJ;IAEA,MAAM,EAAE,OAAO,EAAE,WAAW,EAAE,GAAG,IAAA,uRAAO;iCAAC;YACrC,MAAM,WAAW,MAAM,OAAO,CAAC,aAAa,YAAY,EAAE;YAC1D,MAAM,WAAW,cACX,SAAS,MAAM;yCAAC,CAAC,OACf,KAAK,QAAQ,CACR,WAAW,GACX,QAAQ,CAAC,YAAY,WAAW;0CAEvC;YAEN,OAAO;gBACH,SAAS,SAAS,MAAM;6CAAC,CAAC,OAAS,KAAK,OAAO;;gBAC/C,aAAa,SAAS,MAAM;6CAAC,CAAC,OAAS,CAAC,KAAK,OAAO;;YACxD;QACJ;gCAAG;QAAC;QAAW;KAAY;IAE3B,MAAM,iBAAiB,CAAC,yBACpB,4SAAC,2JAAU;YAAC,WAAU;sBAClB,cAAA,4SAAC;gBAAI,WAAU;0BACV,SAAS,GAAG,CAAC,CAAC,qBACX,4SAAC,wJAAQ;wBAEL,MAAM;4BACF,IAAI,KAAK,MAAM;4BACf,MAAM,KAAK,QAAQ;4BACnB,QAAQ;4BACR,WAAW;4BACX,UAAU,KAAK,OAAO;4BACtB,eAAe,KAAK,YAAY;4BAChC,aAAa,KAAK,WAAW;wBACjC;wBACA,QAAQ;wBACR,QAAQ;wBACR,UAAU;uBAZL,KAAK,MAAM;;;;;;;;;;;;;;;IAmBpC,qBACI;;0BACI,4SAAC;gBAAI,WAAU;;kCAEX,4SAAC;wBAAI,WAAU;;0CACX,4SAAC,qJAAQ;gCAAC,WAAU;0CAAuB;;;;;;0CAG3C,4SAAC,6JAAW;gCACR,OAAO;gCACP,eAAe;gCACf,aAAY;gCACZ,kBAAiB;;;;;;;;;;;;kCAKzB,4SAAC;wBAAI,WAAU;kCACX,cAAA,4SAAC,2IAAI;4BACD,cAAa;4BACb,WAAU;;8CAEV,4SAAC;oCAAI,WAAU;;sDACX,4SAAC,+IAAQ;4CACL,SAAQ;4CACR,WAAU;;8DAEV,4SAAC,kJAAW;oDAAC,OAAM;;sEACf,4SAAC,oTAAS;4DAAC,WAAU;;;;;;wDAAW;;;;;;;8DAEpC,4SAAC,kJAAW;oDAAC,OAAM;;sEACf,4SAAC,oSAAK;4DAAC,WAAU;;;;;;wDAAW;;;;;;;;;;;;;sDAGpC,4SAAC,+IAAM;4CACH,SAAQ;4CACR,MAAK;4CACL,WAAU;4CACV,SAAS,IAAM;4CACf,UAAU;sDAEV,cAAA,4SAAC,oTAAS;gDACN,WAAW,CAAC,OAAO,EAAE,UAAU,iBAAiB,IAAI;;;;;;;;;;;;;;;;;8CAIhE,4SAAC,kJAAW;oCAAC,OAAM;oCAAc,WAAU;8CACtC,wBACG,4SAAC,mKAAY;;;;+CACb,YAAY,MAAM,KAAK,kBACvB,4SAAC,iKAAU;wCACP,OAAM;wCACN,aAAY;;;;;+CAGhB,eAAe;;;;;;8CAGvB,4SAAC,kJAAW;oCAAC,OAAM;oCAAU,WAAU;8CAClC,wBACG,4SAAC,mKAAY;;;;+CACb,QAAQ,MAAM,KAAK,kBACnB,4SAAC,iKAAU;wCACP,OAAM;wCACN,aAAY;wCACZ,sBACI,4SAAC,+IAAM;4CACH,MAAK;4CACL,SAAS,IACL,mBAAmB;;8DAGvB,4SAAC,iSAAI;oDAAC,WAAU;;;;;;gDAAW;;;;;;;;;;;+CAMvC,eAAe;;;;;;;;;;;;;;;;;kCAO/B,4SAAC;wBAAI,WAAU;kCACX,cAAA,4SAAC;4BAAI,WAAU;;8CACX,4SAAC;oCAAI,WAAU;;wCAAoE;wCACtD;wCACxB,MAAM,QAAQ,UAAU;wCAAQ;wCAAE;sDACnC,4SAAC;4CAAK,WAAU;sDACX,MAAM,SAAS,MAAM,SAAS;;;;;;;;;;;;8CAGvC,4SAAC;oCAAI,WAAU;;sDACX,4SAAC,+IAAM;4CACH,MAAK;4CACL,SAAS,IAAM,mBAAmB;4CAClC,WAAU;;8DAEV,4SAAC,iSAAI;oDAAC,WAAU;;;;;;gDAAW;;;;;;;sDAG/B,4SAAC,iKAAY;4CACT,SAAQ;4CACR,MAAK;4CACL,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAO9B,4SAAC,uLAAe;gBACZ,MAAM;gBACN,cAAc;gBACd,WAAW;;;;;;YAGd,+BACG,4SAAC,mLAAa;gBACV,QAAQ;gBACR,MAAM,CAAC,CAAC;gBACR,cAAc,CAAC,OAAS,CAAC,QAAQ,iBAAiB;gBAClD,WAAW;;;;;;;;AAK/B;GAzMwB;;QAIP,+KAAc;QAEvB,+KAAc;QACK,+KAAc;QACtB,iQAAS;;;KARJ"}}]
}